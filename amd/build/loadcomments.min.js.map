{"version":3,"sources":["../src/loadcomments.js"],"names":["define","$","Ajax","LoadComments","registerEventListeners","prototype","click","event","preventDefault","target","currentTarget","postid","data","cardbody","closest","request","call","methodname","args","post","id","done","children","not","remove","comments","forEach","item","userpic","fullname","message","insertBefore","find"],"mappings":"AAuBAA,OAAM,gCAAC,CAAC,QAAD,CAAW,WAAX,CAAD,CAA0B,SAASC,CAAT,CAAYC,CAAZ,CAAkB,CAC9C,GAAIC,CAAAA,CAAY,CAAG,UAAW,CAC1B,KAAKC,sBAAL,EACH,CAFD,CAIAD,CAAY,CAACE,SAAb,CAAuBD,sBAAvB,CAAgD,UAAW,CACvDH,CAAC,CAAC,kBAAD,CAAD,CAAsBK,KAAtB,CAA4B,SAASC,CAAT,CAAgB,CACxCA,CAAK,CAACC,cAAN,GADwC,GAGpCC,CAAAA,CAAM,CAAGR,CAAC,CAACM,CAAK,CAACG,aAAP,CAH0B,CAKpCC,CAAM,CAAGF,CAAM,CAACG,IAAP,CAAY,IAAZ,CAL2B,CAOpCC,CAAQ,CAAGJ,CAAM,CAACK,OAAP,CAAe,YAAf,CAPyB,CASpCC,CAAO,CAAGb,CAAI,CAACc,IAAL,CAAU,CAAC,CACrBC,UAAU,CAAE,iCADS,CAErBC,IAAI,CAAE,CACFC,IAAI,CAAE,CACFC,EAAE,CAAET,CADF,CADJ,CAFe,CAAD,CAAV,CAT0B,CAkBxCI,CAAO,CAAC,CAAD,CAAP,CAAWM,IAAX,CAAgB,SAAST,CAAT,CAAe,CAC3BC,CAAQ,CAACS,QAAT,GAAoBC,GAApB,CAAwB,WAAxB,EAAqCA,GAArC,CAAyC,cAAzC,EAAyDC,MAAzD,GAEAZ,CAAI,CAACa,QAAL,CAAcC,OAAd,CAAsB,SAASC,CAAT,CAAe,CACjC1B,CAAC,CAAC,2DAA6D0B,CAAI,CAACC,OAAlE,0EAEuBD,CAAI,CAACE,QAF5B,wBAGuBF,CAAI,CAACG,OAH5B,yBAAD,CAAD,CAI0BC,YAJ1B,CAIuClB,CAAQ,CAACmB,IAAT,CAAc,cAAd,CAJvC,CAKH,CAND,CAOH,CAVD,CAWH,CA7BD,CA8BH,CA/BD,CAiCA,MAAO,CACH,KAAQ,eAAW,CACf,MAAO,IAAI7B,CAAAA,CACd,CAHE,CAKV,CA3CK,CAAN","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Load comments js logic.\n *\n * @package    format_timeline\n * @copyright  2020 onwards Willian Mano {@link http://conecti.me}\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\ndefine(['jquery', 'core/ajax'], function($, Ajax) {\n    var LoadComments = function() {\n        this.registerEventListeners();\n    };\n\n    LoadComments.prototype.registerEventListeners = function() {\n        $(\".loadallcomments\").click(function(event) {\n            event.preventDefault();\n\n            var target = $(event.currentTarget);\n\n            var postid = target.data('id');\n\n            var cardbody = target.closest('.card-body');\n\n            var request = Ajax.call([{\n                methodname: 'format_timeline_getpostcomments',\n                args: {\n                    post: {\n                        id: postid\n                    }\n                }\n            }]);\n\n            request[0].done(function(data) {\n                cardbody.children().not('.mainpost').not('.add-comment').remove();\n\n                data.comments.forEach(function(item) {\n                    $(\"<div class='post fadeIn'><div class='userimg'><img src='\" + item.userpic + \"'></div>\" +\n                        \"<div class='entry'><div class='entry-content'>\" +\n                        \"<p class='name'>\" + item.fullname + \"</p>\" +\n                        \"<p class='text'>\" + item.message + \"</p>\" +\n                        \"</div></div></div>\").insertBefore(cardbody.find('.add-comment'));\n                });\n            });\n        });\n    };\n\n    return {\n        'init': function() {\n            return new LoadComments();\n        }\n    };\n});\n"],"file":"loadcomments.min.js"}